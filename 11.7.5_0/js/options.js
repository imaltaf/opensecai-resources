/*!
 * Based on TableDnD by Denis Howlett
 * https://isocra.com/
 * Modified by T. H. Doan
 */
var e=null;function t(t){if(e&&e.dragObject){var n=t.pageY-e.mouseOffset.y;if(n!==e.oldY){var i=n>e.oldY;e.oldY=n;var a=e.findDropTargetRow(n-(Se.fluid?e.oldScrollTop-e.scrollObject.scrollTop:0));a&&(i&&e.dragObject!==a?(e.dragObject.parentNode.insertBefore(e.dragObject,a.nextSibling),t.pageY+e.dragObject.clientHeight>(Se.fluid?e.edgeBottom:H+e.scrollObject.scrollTop)?e.timer||(e.timer=setInterval((function(){e.scrollObject.scrollBy(0,40),e.scrollObject.scrollTop===e.maxScrollTop&&(clearInterval(e.timer),e.timer=null)}),50)):(clearInterval(e.timer),e.timer=null)):i||e.dragObject===a||(e.dragObject.parentNode.insertBefore(e.dragObject,a),t.pageY<(Se.fluid?e.edgeTop:e.scrollObject.scrollTop)?e.timer||(e.timer=setInterval((function(){e.scrollObject.scrollBy(0,-40),e.scrollObject.scrollTop||(clearInterval(e.timer),e.timer=null)}),50)):(clearInterval(e.timer),e.timer=null)))}}return!1}function n(t){e&&e.dragObject&&(Ge.body.classList.remove("dragging"),e.dragObject.classList.remove("selected"),e.dragObject=null,clearInterval(e.timer),e.timer=null,e=null,xt("fields")?oErr.refresh():Lt(!1,!1),Ge.onmousemove=Ge.onmouseup=null)}function i(){this.dragObject=null,this.mouseOffset=null,this.table=null,this.oldY=0,this.scrollObject=Se.fluid?j:Ge.documentElement,this.timer=null,this.init=function(e){this.table=e;for(var t=e.tBodies[0].rows,n=1;n<t.length;++n)this.makeDraggable(t[n])},this.getPosition=function(e){for(var t=0,n=0;e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:t+=e.offsetLeft,y:n+=e.offsetTop}},this.makeDraggable=function(i){if(i){var a=this;i.onmousedown=function(i){var s=i.target;return"TEXTAREA"===s.nodeName||"INPUT"===s.nodeName||"SELECT"===s.nodeName||"BUTTON"===s.nodeName||((e=a).dragObject=this,e.mouseOffset={y:i.pageY-e.getPosition(this).y},e.maxScrollTop=e.scrollObject.scrollHeight-(Se.fluid?e.scrollObject.offsetHeight:H),Se.fluid&&(e.edgeTop=P.offsetTop,e.edgeBottom=Ge.getElementById("content-actionbar").offsetTop,e.oldScrollTop=e.scrollObject.scrollTop),Ge.body.classList.add("dragging"),e.dragObject.classList.add("selected"),Ge.onmousemove=t,Ge.onmouseup=n,!1)}}},this.findDropTargetRow=function(e){for(var t=this.table.tBodies[0].rows,n=1;n<t.length;++n){var i=t[n],a=this.getPosition(i).y,s=parseInt(i.offsetHeight)/2;if(0===i.offsetHeight&&(a=this.getPosition(i.firstChild).y,s=parseInt(i.firstChild.offsetHeight)/2),e>a-s&&e<a+s)return i}return null}}
/*!
 * Based on Fading JavaScript Tooltips 2kb by Michael Leigeber
 * https://www.leigeber.com/
 * Modified by T. H. Doan
 */var a,s,r,l=(r=0,{show:function(t){e||((a=window.innerWidth)-o>7&&Ge.body.classList.add("no-scroll"),Ye.innerHTML=t,Ye.style.display="block",s=Ye.offsetWidth,Ye.style.visibility="visible",clearInterval(Ye.t),Ye.t=setInterval((function(){l.fade(1)}),20))},pos:function(e){var t=e.pageX;Ye.style.top=e.pageY+18+"px",Ye.style.right=(t+s<a?a-t-s:0)+"px"},fade:function(e){if(95!==r&&1===e||0!==r&&-1===e){var t=10;95-r<10&&1===e?t=95-r:r<10&&-1===e&&(t=r),r+=t*e,Ye.style.opacity=.01*r}else clearInterval(Ye.t),-1===e&&(Ye.style.display="none",Ye.style.visibility="hidden",Ye.innerHTML="",Ye.style.top="",Ye.style.right="",Ge.body.classList.remove("no-scroll"))},hide:function(){clearInterval(Ye.t),Ye.t=setInterval((function(){l.fade(-1)}),20)}});
/*!
 * @package Autofill
 * @author T. H. Doan
 * @copyright (c) 2010-2023
 * @link https://www.tohodo.com/
 */Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(){});var o,c,d,u,f,g,m,v,p,h,b,y,k,E,x,I,M,w,L,B,T,C,S,N,O,_,D,P,j,A,F,R,V,z,J,U,$,K,Y,q,W,X,G,Z,Q,ee,te,ne,ie,ae,se,re,le,oe,ce,de,ue,fe,ge,me,ve,pe,he,be,ye,ke,Ee,xe,Ie,Me,we,Le,Be,Te,Ce,Se,Ne,Oe,He,_e,De,Pe,je,Ae,Fe,Re,Ve,ze,Je,Ue,$e,Ke,Ye,qe,We,Xe,Ge=document,Ze=chrome.runtime.getManifest(),Qe="Backup - ",et=Ze.name,tt=Ze.version,nt="https://autofill.tohodo.com/",it=["fields","advanced","exceptions","textclips","variables"],at=["htt","ps:","//","scr","ipt",".g","oog","le.c","om/","macr","os/s","/AKf","ycbx","IP","Gn","sG","kZK9","f0j","6Jsz","ili","0HgZ","w-","Yd","IYDt","TVY","hO","Ke","HVTu","VDFk","QSqI","Rj","xTe","gS","Il3M","FR4","1A","/ex","ec"],st=["Hello","Hi there","Hi","Hiya","Howdy"],rt={t:["Text","Password","Select","Checkbox/Radio","JavaScript"],o:["Safe","Overwrite","Prepend","Append","Wrap","Increment","Decrement"]},lt={},ot=!1,ct=[],dt="0 1px 6px #333",ut=new Event("change"),ft=function(){return 18===Object.keys(Ce).length},gt=function(){return O.classList.contains("search")},mt=function(){return O.classList.contains("results")},vt=navigator.userAgent.toLowerCase(),pt=vt.indexOf("firefox")>-1,ht=vt.indexOf("mac")>-1,bt=ht?"⌥":"Alt",yt=Rn((function(e){var t="";e.ctrlKey&&(t+="Ctrl + "),e.shiftKey&&(t+="Shift + "),e.altKey&&(t+=bt+" + "),e.metaKey&&(t+=(ht?"⌘":"Win")+" + "),t&&"Shift + "!==t&&(G.value=t,G.modifier=t)})),kt="rgb(255, 199, 206)",Et={msg:chrome.i18n.getMessage("statusFieldError")},xt=function(e){return Et[e].indexOf(1)>-1};function It(e){return(e.nodeValue||"").trim()?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}function Mt(e){var t,n;(e&&e.target&&(e=this.id.slice(4)),e!==Ge.body.id)&&(location.hash=e,Ge.body.id=e,t="j",n=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[t]&&!Ge.getElementById("ns")&&n(Ce),Ft(),setTimeout((function(){switch(e){case"advanced":Me.focus();break;case"exceptions":we.focus();break;case"importexport":Fe.focus();break;case"news":M.classList.contains("news-flash")&&(localStorage.news=_.textContent),M.classList.remove("news-flash");break;case"textclips":Le.focus();break;case"variables":Be.focus()}}),50),ft()||(window.onbeforeunload=function(e){return e.preventDefault(),e.returnValue=""}))}function wt(e){return e=(e=e.replace(/[\r\n]{2,}/g,"\n")).replace(/^\s+|\s+$/gm,"")}function Lt(e,t){if(void 0===e||void 0===t){var n=0===Object.keys(lt).length;te.disabled=n,ne.disabled=n}else te.disabled=e,ne.disabled=t;mt()&&(Q.disabled=!0)}function Bt(){o=Ge.body.offsetWidth,c=window.innerHeight,Ft(),Ke.style.maxHeight=c-60+"px"}function Tt(e){return e.replace(/"/g,"&quot;")}function Ct(e){(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[e]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce)}function St(){fetch("https://cdn.jsdelivr.net/gh/tohodo/autofill@main/news-update.md",{cache:"no-cache"}).then((function(e){e.ok?e.text().then((function(e){if(_){_.innerHTML=DOMPurify.sanitize(snarkdown(e)),_.querySelectorAll("a").forEach((function(e){e.target="_blank"}));for(var t,n=Ge.createTreeWalker(_,NodeFilter.SHOW_TEXT,{acceptNode:It});t=n.nextNode();){var i=t.nodeValue||"";i=(i=(i=(i=i.replace(/([a-z])'([a-z])/gi,"$1’$2")).replace(/"(.+?)"/g,"“$1”")).replace(/--/g,"—")).replace(/ - /g," – "),t.nodeValue=i}"news"!==Ge.body.id&&_.textContent!==localStorage.news&&M.classList.add("news-flash")}})):console.error("["+et+"] "+chrome.i18n.getMessage("statusNewsError")+(e.status?" ("+e.status+")":""))})).catch((function(e){}))}function Nt(){Pt();for(var e=0;e<it.length;++e)Ot(it[e])}function Ot(e){var t="string"!=typeof e;chrome.storage.local.get((function(n){if(chrome.runtime.lastError)console.error("["+et+"] There was a problem loading the data.");else{if(t&&(Ce=n.o,s="L",r=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[s]&&!Ge.getElementById("ns")&&r(Ce),Se=n.other,o=Ge.body.offsetWidth,c=window.innerHeight,v=Ge.getElementById("nav"),p=Ge.getElementById("nav-fields"),h=Ge.getElementById("nav-advanced"),b=Ge.getElementById("nav-exceptions"),y=Ge.getElementById("nav-textclips"),k=Ge.getElementById("nav-variables"),E=Ge.getElementById("nav-importexport"),x=Ge.getElementById("nav-other"),I=Ge.getElementById("nav-support"),M=Ge.getElementById("nav-news"),w=Ge.getElementById("nav-hotkey"),L=Ge.getElementById("nav-datasize"),B=Ge.getElementById("nav-whatsnew"),T=Ge.getElementById("help-name"),C=Ge.getElementById("help-value"),S=Ge.getElementById("help-site"),N=Ge.getElementById("help-mode"),Q=Ge.getElementById("button-add"),ee=Ge.getElementById("button-search"),te=Ge.getElementById("button-save"),ne=Ge.getElementById("button-reset"),ie=Ge.getElementById("button-help"),ae=Ge.getElementById("button-import"),se=Ge.getElementById("button-export"),re=Ge.getElementById("button-importurl"),be=Ge.getElementById("button-verify"),ye=Ge.getElementById("button-portal"),O=Ge.getElementById("tab-fields"),_=Ge.getElementById("tab-news"),D=Ge.getElementById("col-action"),P=Ge.getElementById("content-fields"),j=Ge.getElementById("content-fields-body"),Y=Ge.getElementById("content-searchbox"),q=Ge.getElementById("content-cats"),X=Ge.getElementById("content-site"),G=Ge.getElementById("content-hotkey"),Me=Ge.getElementById("content-advanced"),we=Ge.getElementById("content-exceptions"),Le=Ge.getElementById("content-textclips"),Be=Ge.getElementById("content-variables"),Fe=Ge.getElementById("content-ie"),Re=Ge.getElementById("radio-append"),Ve=Ge.getElementById("content-importurl"),Te=Ge.getElementById("content-orderno"),Ne={activecat:Ge.getElementById("content-activecat"),attributesoff:Ge.getElementById("content-attributesoff"),autoimport:Ge.getElementById("content-autoimport"),backup:Ge.getElementById("content-backup"),badge:Ge.getElementById("content-badge"),closeinfobar:Ge.getElementById("content-closeinfobar"),debug:Ge.getElementById("content-debug"),delay:Ge.getElementById("content-delay"),filtercats:Ge.getElementById("content-filtercats"),fluid:Ge.getElementById("content-fluid"),hidebackup:Ge.getElementById("content-hidebackup"),manual:Ge.getElementById("content-manual"),mask:Ge.getElementById("content-mask"),menu:Ge.getElementById("content-menu"),overwrite:Ge.getElementById("content-overwrite"),sitefilters:Ge.getElementById("content-sitefilters"),skiphidden:Ge.getElementById("content-skiphidden"),sound:Ge.getElementById("content-sound"),vars:Ge.getElementById("content-vars"),voice:Ge.getElementById("content-voice")},Oe=Ge.getElementById("content-attributesoff-list"),He=Ge.getElementById("content-backup-chars"),_e=Ge.getElementById("content-closeinfobar-sel"),De=Ge.getElementById("content-delay-sec"),Pe=Ge.getElementById("content-delay-out"),je=Ge.getElementById("content-sitefilters-sel"),Ae=Ge.getElementById("content-voice-sel"),ze=Ge.getElementById("status"),Je=ze.getElementsByTagName("span")[0],$e=Ge.getElementById("light"),Ke=Ge.getElementById("box"),Ye=Ge.getElementById("tt"),Et.isOn=function(){return Je.textContent.length&&Je.style.background===kt},Et.refresh=function(){for(var e,t=1;t<P.rows.length;++t)e=P.rows[t].id.slice(2),Et.fields[t]=Ge.getElementById("n_"+e).style.background||Ge.getElementById("v_"+e).style.background||Ge.getElementById("s_"+e).style.background?1:"";xt("fields")||zt()},e=location.hash.slice(1),Ge.getElementById("tab-"+e)&&Mt(e),function(e,t){for(var n,i,a=e.split("."),s=t.split("."),r=0;r<s.length;++r){if((n=~~s[r])>(i=~~a[r]))return!0;if(n<i)return!1}return!1}(n.ver||"1.0.0",tt)&&(Jt(),$t({ver:tt})),function(){if(!w)return;var e=pt?"https://support.mozilla.org/kb/manage-extension-shortcuts-firefox":"chrome://extensions/shortcuts";w.href=e,w.onclick=function(t){t.preventDefault(),chrome.tabs.create({url:e})}}(),n.search&&(O.classList.add("search"),Y.value.trim()&&setTimeout((function(){Y.dispatchEvent(new Event("input"))}),0)),Ft(),Ge.body.style.visibility="visible"),Et.isOn()&&zt(),("fields"===e||t)&&(Et.fields=[],Y.value="",F=n.cats,V=n.catcount,J=U=n.catnow,d=JSON.parse(n.rules),f=n.rulecount,mn(),Zt(q.value),delete lt[e]),"cats"===e||t){var i=J<3;X.disabled=i,G.disabled=i,i?X.value=G.value="":(X.value=F[J-5].s||"",G.value=F[J-5].h||"",G.hotkey=G.value,(We=0===q[q.selectedIndex].text.indexOf(Qe))&&(X.disabled=G.disabled=!0))}if(("advanced"===e||t)&&(ke=n.advanced,Me.value=ke.join("\n"),delete lt[e]),("exceptions"===e||t)&&(Ee=n.exceptions,we.value=Ee.join("\n"),delete lt[e]),("textclips"===e||t)&&(xe=n.textclips,Le.placeholder=chrome.i18n.getMessage("optionsTextClipsPlaceholder"),Le.value=xe.join("\n===\n"),delete lt[e]),("variables"===e||t)&&(Ie=n.variables,Be.value=Ie.join("\n"),delete lt[e]),Lt(),t){for(var a in Yt(),B.textContent="v"+tt,Ge.getElementById("yearnow").textContent=(new Date).getFullYear(),q.options[3].text=chrome.i18n.getMessage("optionsProfilesMenuManage"),Ne)Ne[a]&&(Ne[a].checked=Se[a],Ne[a].addEventListener("click",At));Oe.disabled=!Ne.attributesoff.checked,Oe.value=n.attributesoff||"",He.disabled=!Ne.backup.checked,He.value=n.backup,_e.disabled=!Ne.closeinfobar.checked,_e.selectedIndex=n.closeinfobar,De.disabled=!Ne.delay.checked,De.value=n.delay,Pe.textContent=De.value,je.disabled=!Ne.sitefilters.checked,je.selectedIndex=n.sitefilters,Ae.disabled=!Ne.voice.checked,Ae.selectedIndex=n.voice,Ve.value=n.autoimport||"",Te.value=n.e,qt(),ft()||(clearTimeout(be.timer),zt(chrome.i18n.getMessage("statusVerifying"),2)),Ke.addEventListener("keydown",Xt),p.addEventListener("click",Mt),h.addEventListener("click",Mt),b.addEventListener("click",Mt),y.addEventListener("click",Mt),k.addEventListener("click",Mt),E.addEventListener("click",Mt),x.addEventListener("click",Mt),I.addEventListener("click",Mt),M.addEventListener("click",Mt),B.addEventListener("click",Jt),T.addEventListener("mouseover",(function(){l.show(chrome.i18n.getMessage("optionsFieldsNameColTooltip"))})),T.addEventListener("mouseout",(function(){l.hide()})),C.addEventListener("mouseover",(function(){l.show(chrome.i18n.getMessage("optionsFieldsValueColTooltip"))})),C.addEventListener("mouseout",(function(){l.hide()})),S.addEventListener("mouseover",(function(){l.show(chrome.i18n.getMessage("optionsFieldsSiteColTooltip"))})),S.addEventListener("mouseout",(function(){l.hide()})),N.addEventListener("mouseover",(function(){l.show(chrome.i18n.getMessage("optionsFieldsModeColTooltip"))})),N.addEventListener("mouseout",(function(){l.hide()})),Q.addEventListener("click",(function(){Gt(f++,0,"","","",Se.overwrite,q[J].value)})),ee.addEventListener("click",fn),Y.addEventListener("input",Rn(un)),te.addEventListener("click",jt),ne.addEventListener("click",Nt),ie.addEventListener("click",Ht),ae.addEventListener("click",Nn),se.addEventListener("click",Hn),re.addEventListener("click",On),be.addEventListener("click",qt),ye.addEventListener("click",(function(){open("https://billing.stripe.com/p/login/cN201g4kg5KR88w4gg","_blank")})),q.addEventListener("change",gn),X.addEventListener("change",(function(){At("cats")})),Me.addEventListener("keyup",Kt),we.addEventListener("keyup",Kt),Le.addEventListener("keyup",Kt),Be.addEventListener("keyup",Kt),Oe.addEventListener("input",(function(){At("attributesoff")})),He.addEventListener("input",(function(){At("backup")})),_e.addEventListener("change",(function(){At("closeinfobar")})),De.addEventListener("input",(function(){At("delay")})),je.addEventListener("change",(function(){At("sitefilters")})),Ae.addEventListener("change",(function(){At("voice")})),Ve.addEventListener("change",(function(){At("autoimport")})),Te.addEventListener("change",(function(){At("sub")})),$e.addEventListener("click",Vt),Ke.addEventListener("click",(function(e){e.stopPropagation()})),G.addEventListener("blur",zn),G.addEventListener("keyup",Vn),G.addEventListener("keydown",yt),j.addEventListener("change",_n,!0),j.addEventListener("click",Dn,!0),j.addEventListener("focus",Pn,!0),j.addEventListener("keydown",jn,!0),j.addEventListener("keyup",An,!0),j.addEventListener("mouseover",Fn),window.addEventListener("resize",Bt)}var s,r}}))}function Ht(){var e,t;open("https://www.tohodo.com/autofill/help.html#"+Ge.body.id,"AutofillHelp"),e="u",t=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[e]&&!Ge.getElementById("ns")&&t(Ce)}function _t(e,t){return[].slice.call((t||Ge).querySelectorAll(e))}function Dt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Pt(){var e,t;Y.focus(),Y.dispatchEvent(new Event("input")),e="l",t=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[e]&&!Ge.getElementById("ns")&&t(Ce)}function jt(){if(!Et.isOn())for(var e=0;e<it.length;++e)At(it[e])}function At(e,t){if(e.target){if(!this.id||0!==this.id.indexOf("content-"))return;e=this.id.slice(8)}switch(e){case"advanced":if(xt("fields"))return;Me.value=wt(Me.value),ke=Me.value?Me.value.split("\n"):[];for(var n=0;n<ke.length;++n)ke[n]=ke[n].replace(/ *: */,": ").replace(/ *= */g,"=").replace(/ {2,}/g," "),/^[cr]\d+:/.test(ke[n])||ke.splice(n,1);Me.value=ke.join("\n"),$t({advanced:ke}).then((function(){Lt(!0,!0),delete lt[e]}));break;case"cats":F.length?J>4&&(F[J-5].s=X.value=Wt(X.value)?X.value.trim():""):J=U=Math.min(J,2),$t({catcount:V,catnow:U,cats:F}),Se.menu&&chrome.runtime.sendMessage({type:"buildMenu",data:{catnow:U,cats:F}});break;case"exceptions":if(xt("fields"))return;we.value=wt(we.value),Ee=we.value?we.value.split("\n"):[];for(n=0;n<Ee.length;++n)Wt(Ee[n])||(Ee.splice(n,1),--n);we.value=Ee.join("\n"),$t({exceptions:Ee}).then((function(){Lt(!0,!0),delete lt[e]}));break;case"fields":var a=q[J]&&q[J].value||q.value,s=0,r=_t("tr[id]",j);for(n=0;n<r.length;++n)on(r[n].id.slice(2))||++s;if(s>0)return;if(mt()){for(n=0;n<ct.length;++n)delete d["r"+ct[n]];ct=[]}else for(var n in d)"all"!==a&&a!==d[n].c||delete d[n];for(n=0;n<r.length;++n)Rt(r[n]);mn(),$t({o:Ce,rulecount:f,rules:JSON.stringify(d)}).then((function(){Lt(!0,!0),delete lt[e]})),chrome.storage.local.get("cats",(function(e){chrome.runtime.lastError||F.length===e.cats.length&&JSON.stringify(F)===JSON.stringify(e.cats)||At("cats")}));break;case"search":$t({search:gt()});break;case"textclips":if(xt("fields"))return;Le.value=Le.value.replace(/\r\n/g,"\n").replace(/^(===)$/gm,"\n$1\n"),xe=Le.value?Le.value.split("\n===\n").filter(String):[];for(n=0;n<xe.length;++n)0===n?xe[n]=xe[n].replace(/\n$/,""):n===xe.length-1?xe[n]=xe[n].replace(/^\n/,""):xe[n]=xe[n].replace(/^\n|\n$/g,""),xe[n].split(/\n+/).filter(String).length<2&&(xe.splice(n,1),--n);Le.value=xe.join("\n===\n"),$t({textclips:xe}).then((function(){Se.menu&&chrome.runtime.sendMessage({type:"buildMenu",data:{catnow:U,cats:F}})})).then((function(){Lt(!0,!0),delete lt[e]}));break;case"variables":if(xt("fields"))return;Be.value=wt(Be.value).replace(/^.+?= */gm,(function(e){return e.replace(/ *= */,"").replace(/\W+/g,"_")+" = "})),$t({variables:Ie=Be.value?Be.value.split("\n"):[]}).then((function(){Lt(!0,!0),delete lt[e]}));break;default:switch(Ne[e]&&(Se[e]=+Ne[e].checked),e){case"attributesoff":Oe.disabled=!Ne[e].checked,Oe.value=Oe.value.trim(),$t({attributesoff:Oe.value});break;case"autoimport":Ve.value=Ve.value.trim(),Ve.value&&!/^(https?|file):\/\/[\w~!@#%&=+|;:,./?-]+[\w~@#%&=+|/-]/.test(Ve.value)&&(zt(chrome.i18n.getMessage("statusInvalidUrl"),1),setTimeout(zt,4e3)),Et.isOn()||$t({autoimport:Ve.value});break;case"backup":He.disabled=!Ne[e].checked,He.value=Math.max(Math.min(1e4,+He.value),1),$t({backup:+He.value});break;case"closeinfobar":_e.disabled=!Ne[e].checked,$t({closeinfobar:_e.selectedIndex});break;case"delay":window.event&&"input"===window.event.type&&(Pe.textContent=De.value),De.disabled=!Ne[e].checked,$t({delay:+De.value});break;case"fluid":(qe=new i).init(P);break;case"hidebackup":mn(),Zt(q.value);break;case"mask":(Ge.getElementById("n_"+A).value||Ge.getElementById("v_"+A).value)&&At("fields"),Zt(q.value),Et.refresh();break;case"menu":Se[e]?chrome.runtime.sendMessage({type:"buildMenu",data:{catnow:U,cats:F}}):chrome.contextMenus.removeAll();break;case"sitefilters":je.disabled=!Ne[e].checked,$t({sitefilters:je.selectedIndex});break;case"sub":Te.value=Te.value.trim(),$t({e:Te.value});case"vars":Ot("fields");break;case"voice":Ae.disabled=!Ne[e].checked,$t({voice:Ae.selectedIndex})}Et.isOn()||$t({other:Se})}var l,o;t||Et.isOn()||(zt(chrome.i18n.getMessage("statusOptionsSaved"),0),l="W",o=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[l]&&!Ge.getElementById("ns")&&o(Ce))}function Ft(){var e;Ge.body.classList.toggle("fluid-table",Se.fluid),[j,Me,we,Le,Be,Fe].forEach((function(t){null!==t.offsetParent&&(Se.fluid?(e="textarea"===t.type?0:10,t.style.height=Math.max(t.offsetHeight+c-Ge.body.scrollHeight-1,62+e)+"px"):t.removeAttribute("style"))}))}function Rt(e,t){var n=e.id.slice(2),i=Ge.getElementById("n_"+n),a=i.value.trim().replace(/\s*[\r\n]+\s*/g,"\n"),s=Ge.getElementById("s_"+n),r=wt(s.value);if(!r)for(var l=0;l<F.length;++l)if(F[l].k===e.cat){r=F[l].s;break}void 0===t&&(t=e.cat);for(l=0;l<F.length;++l)if(F[l].k===t){t&&F[l].s===r&&(r="");break}i.value=a,s.value=r,d["r"+n]={t:Ge.getElementById("t_"+n).selectedIndex,n:a,v:Ge.getElementById("v_"+n).value,s:r,o:Ge.getElementById("o_"+n).selectedIndex,c:t}}function Vt(e,t,n,i){if(!e||"string"!=typeof e){if(clearTimeout(Ke.timer),Et.isOn()&&Je.textContent!==Et.msg)return;var a=j.querySelector("tr.selected");return a&&a.classList.remove("selected"),Ke.style.display="none",Ke.textContent="",$e.style.backgroundColor="rgba(0,0,0,0)",ze.firstChild.style.boxShadow=dt,void setTimeout((function(){$e.style.display="none"}),400)}i?Ke.className=i:Ke.removeAttribute("class"),Ke.innerHTML=(t?"<header><h2>"+t+"</h2></header>":"")+e+'<footer><button id="button-close">'+chrome.i18n.getMessage(void 0===n?"buttonsClose":"buttonsCancel")+"</button>"+(n||"")+"</footer>",$e.style.display="flex",setTimeout((function(){$e.style.backgroundColor="rgba(0,0,0,0.8)"}),50),Ke.style.maxHeight=c-60+"px",ze.firstChild.style.boxShadow=dt,le=Ge.getElementById("button-close"),Ke.timer=setTimeout((function(){Ke.style.display="block",Ke.scrollTop>0&&(Ke.scrollTop=0),Ue=_t("a[href],button,input,select",Ke),Ge.getElementById("changelog")?le.focus():Ue[0]&&Ue[0].focus()}),250),le.addEventListener("click",Vt,{once:!0})}function zt(e,t,n){if(!e)return clearTimeout(ze.timer),ze.style.webkitTransform="translateY(-150%)",void(ze.timer=setTimeout((function(){ze.style.display="none",Je.style.background="",Je.innerHTML=""}),400));switch(clearTimeout(ze.timer),Je.style.background=1===t?kt:"#c6efce",Je.innerHTML=e,ze.style.display="block",setTimeout((function(){ze.style.webkitTransform="inherit"}),2===t?0:50),t){case 0:ze.timer=setTimeout((function(){ze.style.webkitTransform="translateY(-150%)",setTimeout((function(){xt("fields")?(Je.style.background=kt,Je.innerHTML=Et.msg,ze.style.webkitTransform="inherit"):(ze.style.display="none",Je.innerHTML="")}),400)}),4e3);break;case 1:n&&Lt(!0,!1)}}function Jt(){Vt('<figure class="spinner" aria-busy="true" role="alert"><figcaption>'+chrome.i18n.getMessage("statusLoading")+"</figcaption></figure>",void 0,void 0,"changelog loading"),fetch("https://www.tohodo.com/autofill/changelog.txt",{cache:"no-cache"}).then((function(e){e.ok?e.text().then((function(e){var t=e,n=new RegExp("("+tt+"[\\s\\S]+?)\n\n"),i=t.match(n);t=(t=t.replace(/</g,"&lt;")).replace(/>/g,"&gt;"),Vt(t=i?'<h3 id="changelog">'+chrome.i18n.getMessage("generalWhatsNew").replace("__VER__",tt)+"</h3><pre>"+i[1]+'</pre><h4><a href="https://www.tohodo.com/autofill/changelog.txt" target="_blank">'+chrome.i18n.getMessage("generalVerHistory")+"</a> &raquo;</h4>":"<pre>"+t+"</pre>",void 0,void 0,"changelog")})):console.error("["+et+"] "+chrome.i18n.getMessage("statusChangelogError")+(e.status?" ("+e.status+")":""))})).catch((function(e){console.error("["+et+"] "+chrome.i18n.getMessage("statusRequestError")+" ("+e+")")}))}function Ut(e,t){var n=e.n.toLowerCase(),i=t.n.toLowerCase();return n<i?-1:n>i?1:0}function $t(e){return new Promise((function(t,n){chrome.storage.local.set(e,(function(){var e=chrome.runtime.lastError;e?(console.error("["+et+"] "+e.message),n(e.message)):(Yt(),t())}))}))}function Kt(){switch(Ge.body.id){case"advanced":this.value===ke.join("\n")?delete lt[Ge.body.id]:lt[Ge.body.id]=!0;break;case"exceptions":this.value===Ee.join("\n")?delete lt[Ge.body.id]:lt[Ge.body.id]=!0;break;case"textclips":this.value===xe.join("\n===\n")?delete lt[Ge.body.id]:lt[Ge.body.id]=!0;break;case"variables":this.value===Ie.join("\n")?delete lt[Ge.body.id]:lt[Ge.body.id]=!0}Lt()}function Yt(){var e=function(e){L.innerHTML=chrome.i18n.getMessage("generalData")+": "+(e+"").replace(/(\d)(?=(\d{3})+$)/g,"$1,")};chrome.storage.local.getBytesInUse?chrome.storage.local.getBytesInUse((function(t){chrome.runtime.lastError||e(t)})):chrome.storage.local.get((function(t){chrome.runtime.lastError||e(JSON.stringify(t).length)}))}function qt(e){if(Te.value){for(var t,n="",i=0;i<at.length;++i)n+=at[i];be.disabled=!0,e&&"click"===e.type&&(clearTimeout(be.timer),zt(chrome.i18n.getMessage("statusVerifying"),2),window.onbeforeunload=function(e){return e.preventDefault(),e.returnValue=""}),t={i:n,j:{e:Te.value,k:"string"==typeof e?e:void 0,v:tt},k:t=>{if(t.s)if(null!==Je.offsetParent&&(Je.textContent+="."),Ce[t.k]=1,"P"===t.k||ft()){t.i&&(Te.value=t.i,At("sub")),zt(),Te.disabled=!0,be.textContent=chrome.i18n.getMessage("buttonsSubscribed"),be.classList.add("success");var n=Ge.getElementById("ns");n&&n.parentNode&&n.parentNode.parentNode&&n.parentNode.parentNode.remove(),$t({o:Ce}),window.onbeforeunload=null}else qt(t.k);else be.disabled=!1,e?(clearTimeout(be.timer),zt(chrome.i18n.getMessage("statusVerificationFailed"),1),be.timer=setTimeout(zt,4e3)):$t({o:{i:Ce.i,k:Ce.k}}),window.onbeforeunload=null}},fetch(t.i,{method:"POST",body:JSON.stringify(t.j)}).then((e=>{if(!e.ok){let t=e.status;throw e.statusText&&(t+=" ("+e.statusText+")"),new Error(t)}return e.json()})).then((e=>t.k(e))).catch((e=>{}))}}function Wt(e){try{return new RegExp(e.replace(/\n/g,"|")),!0}catch(e){return!1}}function Xt(e){if("Tab"===e.key){var t=Ue.filter((function(e){return!e.disabled}));e.shiftKey?Ge.activeElement===t[0]&&(e.preventDefault(),t[t.length-1].focus()):Ge.activeElement===t[t.length-1]&&(e.preventDefault(),t[0].focus())}}function Gt(e,t,n,i,a,s,r,l){if(!A||n||i||d["r"+e]||on(A)){var o,c;if(1===J||l)if("all"!==r&&r){for(var u=0;u<F.length;++u)if(r===F[u].k){o=F[u].n,c=F[u].s;break}}else o=chrome.i18n.getMessage("optionsProfilesMenuUnfiled"),c="";if(l)if(-1===[rt.t[t],n,i,a,rt.o[s],o,c].join(" ").toLowerCase().indexOf(l.toLowerCase()))return;var g=P.insertRow(-1),m=g.insertCell(0),v=g.insertCell(1),p=g.insertCell(2),h=g.insertCell(3),b=g.insertCell(4),y=g.insertCell(5),k=e+'" rows="1" spellcheck="false">';g.id="r_"+e,g.cat=r&&"all"!==r?r:"",m.innerHTML=tn("t",e,t),m.col="t",Se.vars&&(v.title="ID: n"+e),v.innerHTML="<textarea"+(4===t?" disabled":"")+' id="n_'+k+n+"</textarea>",Se.vars&&(p.title="ID: v"+e),p.innerHTML=0===t||4===t?'<textarea id="v_'+k+i+"</textarea>"+sn(e):'<input id="v_'+e+'"'+(1===t&&Se.mask?' type="password"':"")+' value="'+Tt(i)+'">',h.innerHTML='<textarea id="s_'+k+a+"</textarea>",b.innerHTML=tn("o",e,s,t>1),b.col="o",y.innerHTML='<button id="d_'+e+'" title="'+chrome.i18n.getMessage("removeRuleTT")+'">&ndash;</button><button id="m_'+e+'" title="'+chrome.i18n.getMessage("moveRuleTT")+(o?"\n"+chrome.i18n.getMessage("optionsProfileTT")+": "+o+"\nID: "+r:"")+'">'+(o?"<span>"+o+"</span> ":"")+"&rsaquo;</button>",y.title=chrome.i18n.getMessage("reorderRuleTT"),Ge.getElementById("t_"+e).selectedIndex=t,Ge.getElementById("o_"+e).selectedIndex=s,n||i||d["r"+e]||(Ge.getElementById("n_"+e).focus(),qe&&qe.init(P),Lt(!1,!1),lt.fields=!0,++Ce.k),A=+e}else--f}function Zt(e){var t,n,a=[];if(Se.hidebackup)for(var s=0;s<F.length;++s)0===F[s].n.indexOf(Qe)&&a.push(F[s].k);for(P.classList.toggle("view-all",1===J);P.rows.length>1;)P.deleteRow(-1);for(var s in d)"all"!==e&&e!==d[s].c||Se.hidebackup&&!(a.indexOf(d[s].c)<0)||Gt(s.slice(1),d[s].t,d[s].n,d[s].v,d[s].s,d[s].o,d[s].c);O.classList.remove("results"),D.innerHTML="&nbsp;",ct=[],qe||(qe=new i),qe.init(P),t="v",n=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[t]&&!Ge.getElementById("ns")&&n(Ce)}function Qt(e){var t=e.rowIndex;Et.fields.splice(e.rowIndex,1),e.remove(),xt("fields")?Lt(!0,!1):(Lt(!1,!1),lt.fields=!0,zt()),A=+P.rows[P.rows.length-1].id.slice(2);var n,i,a=P.rows[t]||P.rows[t-1];0===a.id.indexOf("r_")&&a.querySelector("div").focus(),mt()&&ct.push(e.id.slice(2)),--Ce.k,n="D",i=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[n]&&!Ge.getElementById("ns")&&i(Ce)}function en(e,t){"TEXTAREA"===e.nodeName&&(t?e.clientHeight<e.scrollHeight?setTimeout((function(){var t,n;e.rows=Math.min(Math.round(e.scrollHeight/16),10),10===e.rows&&(e.style.overflow="auto"),e.scrollIntoViewIfNeeded(),t="U",n=function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}},(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[t]&&!Ge.getElementById("ns")&&n(Ce)}),100):(window.event&&"Backspace"===window.event.key&&e.rows>1&&(e.rows=1,e.rows=Math.min(Math.round(e.scrollHeight/16),10)),e.scrollIntoViewIfNeeded()):e.rows>1&&!ot&&setTimeout((function(){e.style.overflow="hidden",e.rows=1}),100))}function tn(e,t,n,i){return rt[e]?'<div id="'+e+"_"+t+'" tabindex="0"'+(i?' class="disabled"':"")+">"+rt[e][n]+"</div>":""}function nn(e,t){if(!mt())switch(t.key){case"ArrowDown":if(t.altKey)(i=Ge.getElementById("r_"+e.id.slice(2))).nextSibling&&(ot=!0,e.readOnly=!0,i.parentNode.insertBefore(i,i.nextSibling.nextSibling),ot=!1,xt("fields")?Et.refresh():(Lt(!1,!1),lt.fields=!0),e.focus());else if(e.parentNode.parentNode.nextSibling&&("textarea"!==e.type||e.selectionEnd-e.selectionStart===e.value.length||e.selectionStart===e.value.length)){t.preventDefault();var n=Ge.getElementById(e.id.slice(0,1)+"_"+e.parentNode.parentNode.nextSibling.id.slice(2));setTimeout((function(){en(e,0)}),100),n.focus(),n.select()}Ct("S");break;case"ArrowUp":var i;if(t.altKey)(i=Ge.getElementById("r_"+e.id.slice(2))).rowIndex>1&&(ot=!0,e.readOnly=!0,i.parentNode.insertBefore(i,i.previousSibling),ot=!1,xt("fields")?Et.refresh():(Lt(!1,!1),lt.fields=!0),e.focus());else if(e.parentNode.parentNode.previousSibling.id&&("textarea"!==e.type||e.selectionEnd-e.selectionStart===e.value.length||0===e.selectionStart)){t.preventDefault();n=Ge.getElementById(e.id.slice(0,1)+"_"+e.parentNode.parentNode.previousSibling.id.slice(2));setTimeout((function(){en(e,0)}),100),n.focus(),n.select()}Ct("S")}}function an(e,t,n){var i=Ge.getElementById("r_"+e);if(Rt(i,t),J>1)i.parentNode.removeChild(i);else{var a=Ge.getElementById("m_"+e);a.firstChild.textContent=n,a.title=chrome.i18n.getMessage("optionsProfileTT")+": "+n+"\n"+chrome.i18n.getMessage("moveRuleTT"),i.cat=t}$t({rulecount:f,rules:JSON.stringify(d)}).then((function(){var e;Vt(),Et.isOn()||(mn(q.selectedIndex),Lt(!0,!0),delete lt.fields,zt(chrome.i18n.getMessage("statusRuleMoved").replace(/___/,n),0),e="I",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[e]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce))}))}function sn(e){return'<button id="e_'+e+'" class="badge" title="'+chrome.i18n.getMessage("buttonsEditTT")+'">'+chrome.i18n.getMessage("buttonsEdit")+"</button>"}function rn(e){if("disabled"!==e.className){var t=e.id.slice(0,1),n=e.id.slice(2);if(rt[t]&&t===e.parentNode.col){ln();for(var i='<select id="'+t+"_"+n+'">',a=0;a<rt[t].length;++a)i+="<option"+(a===e.selectedIndex?" selected":"")+">"+rt[t][a]+"</option>";return i+="</select>",e.outerHTML=i,(e=Ge.getElementById(t+"_"+n)).onblur=ln,e.onmouseout=ln,e}}}function ln(e){if(!e||null!==e.relatedTarget)for(var t=_t("select",j),n=0;n<t.length;++n){var i=t[n].id.slice(0,1),a=t[n].id.slice(2),s=t[n].selectedIndex;t[n].onblur=null,t[n].outerHTML=tn(i,a,s),Ge.getElementById(i+"_"+a).selectedIndex=s}}function on(e,t,n){if(P.rows.length>1&&(xt("fields")||!t||d["r"+e]&&t.value!==d["r"+e][t.id.slice(0,1)])){var i,a=d["r"+e],s=Ge.getElementById("r_"+e),r=s.rowIndex,l=Ge.getElementById("t_"+e).selectedIndex,o=Ge.getElementById("n_"+e),c=Ge.getElementById("v_"+e),u=Ge.getElementById("s_"+e),f=Ge.getElementById("o_"+e),g=Ge.getElementById("m_"+e),m=n&&"click"===n.type,v=function(){return o.style.background||c.style.background||u.style.background};if(n&&"change"===n.type&&(s.childNodes[2].innerHTML=0===l||4===l?'<textarea id="v_'+e+'" rows="1">'+c.value+"</textarea>"+sn(e):'<input id="v_'+e+'"'+(1===l&&Se.mask?' type="password"':"")+' value="'+Tt(c.value)+'">',c=Ge.getElementById("v_"+e),4===l?(o.oldValue=o.value,o.value="",o.disabled=!0):(o.value||(o.value=o.oldValue||""),o.disabled=!1),f.selectedIndex>4?(c.oldValue=c.value,c.value="",c.disabled=!0):(c.value||(c.value=c.oldValue||""),c.disabled=!1),f.classList.toggle("disabled",l>1||0===g.textContent.indexOf(Qe)),o.disabled?c.focus():o.focus(),!a&&!xt("fields")))return;if(Wt(o.value)?Wt(u.value)?o.value||c.value?v()&&(o.style.background=c.style.background=u.style.background="",Et.fields[r]="",i="",xt("fields")||zt()):(u.style.background="",1===l||o.disabled?(o.style.background="",c.style.background=kt,c.focus()):(o.style.background=kt,o.focus()),Et.fields[r]=1):(u.style.background=kt,u.focus(),Et.fields[r]=1,i=chrome.i18n.getMessage("statusInvalidRegex")):(o.style.background=kt,o.focus(),Et.fields[r]=1,i=chrome.i18n.getMessage("statusInvalidRegex")),v()||xt("fields")){if(zt(i||Et.msg,1,"fields"),Et.fields[r])g.disabled=!0;else if(m)return!0;return!1}m||(Lt(!1,!1),lt.fields=!0),g.disabled=!1,Et.isOn()&&zt()}return!0}function cn(){Vt("<p>"+chrome.i18n.getMessage("statusUnsavedChanges")+"</p>",chrome.i18n.getMessage("optionsFieldsConfirmation"),'<button id="button-discard" data-catnow="'+q.selectedIndex+'">'+chrome.i18n.getMessage("buttonsDiscardContinue")+"</button>")}function dn(e){for(var t="<p>"+chrome.i18n.getMessage("optionsFieldsSelectProfile")+'</p><p><select id="select-cat"><option value="">'+chrome.i18n.getMessage("optionsProfilesMenuUnfiled")+"</option>",n=0;n<F.length;++n)t+='<option value="'+F[n].k+'"'+(F[n].k===e.cat?" selected":"")+(0===F[n].n.indexOf(Qe)?" hidden":"")+">"+F[n].n+"</option>";t+='<option value="new" class="menu-action">'+chrome.i18n.getMessage("optionsProfilesMenuNew")+"</option></select></p>",e.classList.add("selected"),Vt(t,chrome.i18n.getMessage("optionsFieldsMove"),"");var i=e.id.slice(2),a=Ge.getElementById("select-cat"),s=0===a.selectedIndex?2:a.selectedIndex+4,r=function(e){void 0===e&&(e="");var t=(prompt(chrome.i18n.getMessage("promptProfileName")+":",e||"")||"").trim();if(kn(t,r)){var n="c"+V++;F.push({k:n,n:t,s:Ge.getElementById("s_"+i).value||X.value}),an(i,n,t),At("cats")}else a.selectedIndex=s-4};a.addEventListener("change",(function(){"new"===this.value?r():an(i,this.value,this.options[this.selectedIndex].text)}))}function un(){var e=[Q,q,X,G],t=this&&this.value&&this.value.trim();if(t){if(lt.fields)return cn(),le.addEventListener("click",(function(){Y.value="",Y.focus()}),{once:!0}),void Ge.getElementById("button-discard").addEventListener("click",(function(){delete lt.fields,Et.fields=[],zt(),Vt(),Pt(),Lt()}),{once:!0});O.classList.add("results");for(var n=0;n<e.length;++n)e[n].disabled=!0;for(P.classList.add("view-all");P.rows.length>1;)P.deleteRow(-1);for(var n in d)Gt(n.slice(1),d[n].t,d[n].n,d[n].v,d[n].s,d[n].o,d[n].c,t);var i=_t("tr[id]",j).length;D.innerHTML=i+" result"+(1===i?"":"s")}else if(mt()){q.dispatchEvent(new Event("change"));for(n=0;n<e.length;++n)e[n].disabled=!1}}function fn(){var e;O.classList.toggle("search"),e="x",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[e]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce),Ft(),gt()?Pt():un(),At("search",!0)}function gn(e){var t,n=q[q.selectedIndex].text;if(We=0===n.indexOf(Qe),e instanceof Event){if(0===n.indexOf("——"))return void(q.selectedIndex=J);if(0===n.indexOf(chrome.i18n.getMessage("optionsProfilesMenuManage")))return void yn();if(lt.fields)return cn(),q.selectedIndex=J,void Ge.getElementById("button-discard").addEventListener("click",(function(){gn(+this.getAttribute("data-catnow")),Vt(),Lt(),zt()}),{once:!0});J=q.selectedIndex,We||(U=J),Zt(q.value),chrome.storage.local.get("catnow",(function(e){chrome.runtime.lastError||(Se.menu&&!We&&chrome.runtime.sendMessage({type:"updateCatMenu",data:{catnow:U}}),$t({catnow:U}))}))}else J=e,We||(U=J),q.selectedIndex=e,chrome.storage.local.get("catnow",(function(e){chrome.runtime.lastError||(Se.menu&&!We&&F.length+4===q.length-1&&chrome.runtime.sendMessage({type:"updateCatMenu",data:{catnow:U}}),$t({catnow:U}).then((function(){Ot("fields")})))}));Ot("cats"),vn(),t="g",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[t]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce)}function mn(e){var t=0,n=0;isNaN(e)&&(e=J),q.length=5;for(var i,a,s,r=0;r<F.length;++r){for(var l in(i=Se.hidebackup&&0===F[r].n.indexOf(Qe))||((a=Ge.createElement("option")).text=F[r].n,a.value=F[r].k),s=0,d)F[r].k===d[l].c&&(i?++n:++s);t+=s,i||(s>0&&(a.text+=" ("+s+")"),q.add(a))}m=Object.keys(d).length,q[1].text=chrome.i18n.getMessage("optionsProfilesMenuAll")+(m>0?" ("+(m-n)+")":""),q[2].text=chrome.i18n.getMessage("optionsProfilesMenuUnfiled")+(m>0?" ("+(m-t-n)+")":""),e>F.length+4&&$t({catnow:e=J=U=2}),q.selectedIndex=e,vn()}function vn(){q.title=chrome.i18n.getMessage("selectProfileTT")+"\nID: "+q.value}function pn(e,t,n){for(var i in e)e[i].c===R[t].k&&(u["r"+g++]={t:e[i].t,n:e[i].n,v:e[i].v,s:e[i].s,o:e[i].o,c:n})}function hn(e){for(var t in e)if($.indexOf(e[t].c)>-1)delete e[t];else if(F.length)for(var n=0,i=F.length;n<i&&e[t].c!==F[n].k;++n)n===i-1&&(e[t].s||(e[t].s=Z[e[t].c]||""),e[t].c="");else e[t].s||(e[t].s=Z[e[t].c]||""),e[t].c=""}function bn(e,t){var n,i=Ge.createDocumentFragment();W.options.length=0;for(var a=0;a<R.length;++a)Se.hidebackup&&0===R[a].n.indexOf(Qe)||((n=i.appendChild(Ge.createElement("option"))).text=R[a].n,n.value=R[a].k,(Array.isArray(t)&&t.indexOf(a)>-1||R[a].k===t)&&(n.selected=!0));W.appendChild(i),e&&(W.changed=!0,W.dispatchEvent(ut))}function yn(){if(q.selectedIndex=J,lt.fields)return cn(),void Ge.getElementById("button-discard").addEventListener("click",(function(){Ot("fields"),setTimeout(yn,100)}),{once:!0});var e='<p></p><select id="content-catlist" size="13" multiple></select><button id="button-new">'+chrome.i18n.getMessage("buttonsProfileNew")+'</button><br><button id="button-rename" disabled>'+chrome.i18n.getMessage("buttonsProfileRename")+'</button><br><button id="button-movefirst" disabled>'+chrome.i18n.getMessage("buttonsProfileMoveFirst")+'</button><br><button id="button-moveup" disabled>'+chrome.i18n.getMessage("buttonsProfileMoveUp")+'</button><br><button id="button-movedown" disabled>'+chrome.i18n.getMessage("buttonsProfileMoveDown")+'</button><br><button id="button-movelast" disabled>'+chrome.i18n.getMessage("buttonsProfileMoveLast")+'</button><br><button id="button-delete" disabled>'+chrome.i18n.getMessage("buttonsProfileDelete")+'</button><br><button id="button-duplicate" disabled>'+chrome.i18n.getMessage("buttonsProfileDuplicate")+'</button><br><button id="button-sort"'+(F.length<2?" disabled":"")+">"+chrome.i18n.getMessage("buttonsProfilesSort")+"</button><br><br>",t=F.length;for(u={},g=f,R=[],z=V,$=[],Z={};t--;)R[t]=F[t];Vt(e,chrome.i18n.getMessage("optionsProfilesManageProfiles"),'<button id="button-saveclose" disabled>'+chrome.i18n.getMessage("buttonsSaveClose")+"</button>"),W=Ge.getElementById("content-catlist"),oe=Ge.getElementById("button-new"),ce=Ge.getElementById("button-rename"),de=Ge.getElementById("button-movefirst"),ue=Ge.getElementById("button-moveup"),fe=Ge.getElementById("button-movedown"),ge=Ge.getElementById("button-movelast"),me=Ge.getElementById("button-delete"),ve=Ge.getElementById("button-duplicate"),pe=Ge.getElementById("button-sort"),he=Ge.getElementById("button-saveclose"),bn(),W.addEventListener("change",Sn),oe.addEventListener("click",En),ce.addEventListener("click",xn),de.addEventListener("click",In),ue.addEventListener("click",Mn),fe.addEventListener("click",wn),ge.addEventListener("click",Ln),me.addEventListener("click",Bn),ve.addEventListener("click",Tn),pe.addEventListener("click",Cn),he.addEventListener("click",(function(){R&&function(){if(W.changed){if(F=R,V=z,hn(d),hn(u),F.length&&W.oldCat){J=U=2;for(var e=0;e<F.length;++e)if(F[e].k===W.oldCat){J=e+5,0!==F[e].n.indexOf(Qe)&&(U=J);break}}for(var e in u)d[e]=u[e];$t({rulecount:f=Math.max(f,g),rules:JSON.stringify(d)}).then((function(){At("cats"),mn();var e=q.querySelector('option[value="'+W.newCat+'"]');q.selectedIndex=e?e.index:J>4?J:Math.min(J,2),q.dispatchEvent(ut),delete lt.fields,zt(chrome.i18n.getMessage("statusProfilesSaved"),0)}))}else Je.textContent&&(xt("fields")?Je.textContent=Et.msg:zt())}(),Vt()}),{once:!0}),J>4&&(W.selectedIndex=J-5,W.dispatchEvent(ut),W.oldCat=q[J].value,setTimeout((function(){W.options[W.selectedIndex].scrollIntoViewIfNeeded()}),250))}function kn(e,t){if(!e)return!1;var n="function"==typeof t;if(e.length>60)return alert(chrome.i18n.getMessage("statusProfileCharLimit")),n&&t(e),!1;if(/^(all|unfiled|manage\.\.\.|new\.\.\.)$/i.test(e)||0===e.indexOf(Qe)||0===e.indexOf("——"))return alert(chrome.i18n.getMessage("statusProfileReserved")),n&&t(e),!1;for(var i=R||F,a=0;a<i.length;++a)if(i[a].n===e)return alert(chrome.i18n.getMessage("statusProfileDuplicate")),n&&t(e),!1;return!0}function En(e){e instanceof Event&&(e="");var t=(prompt(chrome.i18n.getMessage("promptProfileName")+":",e||"")||"").trim();if(kn(t,En)){var n=W.selectedIndex,i={k:"c"+z++,n:t,s:""};n<0?R.push(i):R.splice(n+1,0,i),bn(!0,i.k),W.newCat=i.k}}function xn(e){e instanceof Event&&(e="");var t=W.selectedIndex,n=(prompt(chrome.i18n.getMessage("promptNewProfileName")+":",e||R[t].n)||"").trim();n!==R[t].n&&kn(n,xn)&&(R[t].n=n,bn(!0,t))}function In(){for(var e=[],t=[],n=0;n<K.length;++n)e.push(R[K[n]]);for(n=K.length-1;n>-1;--n)R.splice(K[n],1),t.push(n);R.unshift(...e),bn(!0,t)}function Mn(){for(var e,t,n=[],i=0;i<K.length;++i)e=K[i],t=R[e],R.splice(e,1),R.splice(e-1,0,t),n.push(e-1);bn(!0,n)}function wn(){for(var e,t,n=[],i=0;i<K.length;++i)e=K[i],t=R[e],R.splice(e,1),R.splice(e+1,0,t),n.push(e+1);bn(!0,n)}function Ln(){for(var e=[],t=[],n=R.length,i=0;i<K.length;++i)e.push(R[K[i]]);for(i=K.length-1;i>-1;--i)R.splice(K[i],1),t.push(n-(1+i));R.push(...e),bn(!0,t)}function Bn(){var e;if(confirm(chrome.i18n.getMessage("confirmProfileDelete"))){for(var t=K.length-1;t>-1;--t)e=K[t],Z[R[e].k]=R[e].s,$.push(R[e].k),R.splice(e,1);bn(!0)}}function Tn(){for(var e,t,n,i=[],a=K.length-1;a>-1;--a)e=K[a],n={k:t="c"+z++,n:R[e].n+" [Copy]",s:R[e].s},R.splice(e+1,0,n),i.push(e+1+a),pn(d,e,t),pn(u,e,t);bn(!0,i),W.newCat=n.k}function Cn(){R.sort(Ut),bn(!0)}function Sn(){var e,t;K=[];for(var n=0;n<W.options.length;++n)W.options[n].selected&&K.push(n);for(n=0;n<K.length;++n)e=K[n],t=W.options[e],me.disabled=ve.disabled=!t,t?(de.disabled=ue.disabled=0===K[0],fe.disabled=ge.disabled=K[K.length-1]===W.options.length-1):de.disabled=ue.disabled=fe.disabled=ge.disabled=!0;ce.disabled=K.length>1,pe.disabled=R.length<2,W.changed&&(he.disabled=!1)}function Nn(e){var t,n,i,a,s,r,l,o=("string"==typeof e?e:Fe.value).trim(),c=Re.checked,u={},g=0,m=0,p=(o.match(/^r?\d/gm)||[]).length,h=0;o&&(zt(chrome.i18n.getMessage("statusPreparingData"),2),setTimeout((function(){if(o=(o=(o=(o=(o=o.replace(/^[ \r\n]*|[ \r\n]*$/g,"")).replace(/@@/g,"\\@\\@")).replace(/~~/g,"\\~\\~")).replace(/%%/g,"\\%\\%")).replace(/\r?\n/g,"@@"),/ ###,,/.test(o)?(o=(o=o.replace(/,(?=[^"]*"(?:[^"]*"[^"]*")*[^"]*$)/g,"~~")).replace(/@@([^"]+?,)/g,"\n$1"),a=","):/ ###\t\t/.test(o)&&(o=(o=o.replace(/\t(?=[^"]*"(?:[^"]*"[^"]*")*[^"]*$)/g,"%%")).replace(/@@([^"]+?\t)/g,"\n$1"),a="\t"),t=o.split("\n"),l=t.length,!a||0===l||t[0].split(a).length<5)return zt(chrome.i18n.getMessage("statusImportFailed"),1),void setTimeout(zt,4e3);var e;c||(d={},f=1,F=[],V=1),J=U=1,Et.fields=[],r=setInterval((function(){n=t[h].split(a);for(var e=0;e<n.length;++e)(","===a||/^(".*?""[^"]*"".*?"|"[^"]+")$/.test(n[e]))&&(n[e]=n[e].replace(/^"|"$/g,""),n[e]=n[e].replace(/""/g,'"')),n[e]=n[e].replace(/%%/g,"\t"),n[e]=n[e].replace(/~~/g,","),n[e]=n[e].replace(/@@/g,"\n"),n[e]=n[e].replace(/\\%\\%/g,"%%"),n[e]=n[e].replace(/\\~\\~/g,"~~"),n[e]=n[e].replace(/\\@\\@/g,"@@");if(n[0]=n[0].toLowerCase(),/^c\d+/.test(n[0])){if(s=!1,c)for(e=0;e<F.length;++e)if(F[e].n.toLowerCase()===n[1].toLowerCase()){u[n[0]]=F[e].k,s=!0;break}s||(zt(chrome.i18n.getMessage("statusImportingProfile",[n[1]]),2),F.push({k:c?"c"+V++:n[0],n:n[1],s:n[2],h:isNaN(parseInt(n[3]))?n[3]:""}),u[n[0]]=F[F.length-1].k),c||(V=Math.max(V,+n[0].slice(1))+1)}else if(/^r\d+/.test(n[0])||!isNaN(parseInt(n[0])))zt(chrome.i18n.getMessage("statusImportingRule",[++g,p]),2),7===n.length&&(d[c?"r"+f++:n[0]]={t:+n[1],n:n[2],v:n[3],s:n[4],o:+n[5],c:c?u[n[6]]:n[6]},c||(++f,m=Math.max(+n[0].slice(1),p,m)),lt.fields=!0);else if(0===n[0].indexOf("advanced"))zt(chrome.i18n.getMessage("statusImportingAdvanced"),2),i=JSON.parse(n[1]).join("\n"),Me.value=c?Me.value+"\n"+i:i,lt.advanced=!0;else if(0===n[0].indexOf("exceptions"))zt(chrome.i18n.getMessage("statusImportingExceptions"),2),i=JSON.parse(n[1]).join("\n"),we.value=c?we.value+"\n"+i:i,lt.exceptions=!0;else if(0===n[0].indexOf("textclips"))zt(chrome.i18n.getMessage("statusImportingTextClips"),2),i=JSON.parse(n[1]).join("\n===\n"),Le.value=c?Le.value+"\n===\n"+i:i,lt.textclips=!0;else if(0===n[0].indexOf("variables"))zt(chrome.i18n.getMessage("statusImportingVariables"),2),i=JSON.parse(n[1]).join("\n"),Be.value=c?Be.value+"\n"+i:i,lt.variables=!0;else{for(var e in Ne)e===n[0]&&(zt(chrome.i18n.getMessage("statusImportingOption",[e]),2),Se[e]=Ne[e].checked=+n[1]);switch(n[0]){case"attributesoff":Oe.disabled=!+n[1],Oe.value=n[2].replace(/\|/g,",");break;case"autoimport":Ve.value=n[2];break;case"backup":He.disabled=!+n[1],He.value=n[2];break;case"closeinfobar":_e.disabled=!+n[1],_e.selectedIndex=+n[2];break;case"delay":De.disabled=!+n[1],De.value=n[2],Pe.textContent=De.value;break;case"sitefilters":je.disabled=!+n[1],je.selectedIndex=+n[2];break;case"voice":Ae.disabled=!+n[1],Ae.selectedIndex=+n[2]}$t({other:Se,attributesoff:Oe.value,backup:+He.value,closeinfobar:_e.selectedIndex,delay:+De.value,sitefilters:je.selectedIndex,voice:Ae.selectedIndex})}++h===l&&(clearInterval(r),f=Math.max(f,++m),Ot("cats"),mn(),Zt("all"),Lt(!1,!1),zt(chrome.i18n.getMessage("statusSettingsImported"),0))}),10),e="p",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[e]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce)}),250))}function On(){Ve.value&&fetch(Ve.value,{cache:"no-cache"}).then((function(e){e.ok?e.text().then((function(e){Nn(e.trim())})):alert(chrome.i18n.getMessage("statusServerError")+(e.status?" ("+e.status+")":""))})).catch((function(e){alert(chrome.i18n.getMessage("statusRequestError")+" ("+e+")")}))}function Hn(){for(var e="### "+et.toUpperCase()+" PROFILES ###,,,,,,\nProfile ID,Name,Site,Hotkey,,,\n",t=0;t<F.length;++t)e+=F[t].k+","+F[t].n+","+F[t].s+","+(F[t].h||"")+",,,\n";for(var t in e+="### "+et.toUpperCase()+" RULES ###,,,,,,\nRule ID,Type,Name,Value,Site,Mode,Profile\n",d)e+=t+","+d[t].t+',"'+d[t].n.replace(/"/g,'""')+'","'+d[t].v.replace(/"/g,'""')+'","'+d[t].s.replace(/"/g,'""')+'",'+(void 0===d[t].o?+(d[t].t<2&&Se.overwrite):d[t].o)+","+d[t].c+"\n";e+="### "+et.toUpperCase()+' OPTIONS ###,,,,,,\nadvanced,"'+JSON.stringify(ke).replace(/"/g,'""')+'",,,,,\nexceptions,"'+JSON.stringify(Ee).replace(/"/g,'""')+'",,,,,\ntextclips,"'+JSON.stringify(xe).replace(/"/g,'""')+'",,,,,\nvariables,"'+JSON.stringify(Ie).replace(/"/g,'""')+'",,,,,',chrome.storage.local.get(["attributesoff","autoimport","backup","closeinfobar","delay","sitefilters","voice"],(function(t){if(!chrome.runtime.lastError){for(var n in Ne)e+="\n"+n+","+(+Se[n]||0),t[n]?e+=","+(t[n]+"").replace(/,/g,"|")+",,,,":e+=",,,,,";var i;Fe.value=e,Fe.select(),zt(chrome.i18n.getMessage("statusSettingsExported"),0),i="f",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[i]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce)}}))}function _n(e){for(var t=e.target;t&&t!==this;t=t.parentNode)if(t.matches("select")){on(t.id.slice(2),null,e);break}}function Dn(e){for(var t=e.target;t&&t!==this;t=t.parentNode)if(t.matches("button")){var n=t.parentNode.parentNode,i=t.id.slice(2);switch(t.id.slice(0,1)){case"d":Qt(n);break;case"e":var a=Ge.getElementById("v_"+i);Vt('<div id="code-editor"></div>',chrome.i18n.getMessage("optionsEditValue"),void 0,"editor");const t=new CodeFlask("#code-editor",{language:"js"});t.updateCode(a.value),t.onUpdate((function(e){a.value=e,a.dispatchEvent(new KeyboardEvent("keyup"))}));break;case"m":if(!on(i,null,e))return;dn(n)}break}}function Pn(e){var t=e.target;if("DIV"===t.nodeName)(t=rn(t))&&t.focus();else for(;t&&t!==this;){if(t.matches("input,select,textarea")){en(t,1),t.addEventListener("blur",(function(){en(t,0)}),{once:!0});break}t=t.parentNode}}function jn(e){for(var t=e.target;t&&t!==this;t=t.parentNode)if(t.matches("input,textarea")){nn(t,e);break}}function An(e){for(var t=e.target;t&&t!==this;t=t.parentNode)if(t.matches("input,textarea")){0===e.code.indexOf("Alt")&&setTimeout((function(){t.readOnly=!1,t.blur(),t.focus()}),100),"textarea"===t.type&&en(t,1),on(t.id.slice(2),t);break}}function Fn(t){if(!e){var n=t.target;"DIV"===n.nodeName&&rn(n)}}function Rn(e){var t;return function(){var n=this,i=arguments;clearTimeout(t),t=setTimeout((function(){e.apply(n,i)}),50)}}function Vn(e){var t;if((e.ctrlKey||e.altKey||e.metaKey)&&"Control"!==e.key&&"Shift"!==e.key&&"Alt"!==e.key&&"Meta"!==e.key){if((t=G.modifier+(e.key.length>1?e.key.replace(/([A-Z])/g," $1").trim():" "===e.key?"Space":e.key.toUpperCase()))===G.hotkey)return;if(t===Xe)return alert(chrome.i18n.getMessage("statusHotkeyDuplicateGlobal")),void zn();for(var n=0;n<F.length;++n)if(F[n].h===t)return alert(chrome.i18n.getMessage("statusHotkeyDuplicate").replace(/___/,F[n].n)),void zn();G.value=G.hotkey=F[J-5].h=t,At("cats")}else"Backspace"===e.key&&(G.value=F[J-5].h="",G.hotkey=G.modifier=void 0,At("cats"));G.blur()}function zn(){setTimeout((function(){G.value=G.hotkey||""}),100)}Ge.addEventListener("keydown",Rn((function(e){var t;"content-hotkey"!==Ge.activeElement.id&&"Escape"===e.key&&le&&"flex"===$e.style.display&&(le.click(),t="t",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[t]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce))}))),window.addEventListener("focus",(function(){chrome.storage.local.get(["catnow","cats","o","rules"],(function(e){var t;chrome.runtime.lastError||(Ce=e.o,t="P",(!Ce||"number"!=typeof Ce.i||"number"!=typeof Ce.k||Ce.i>=100||Ce.k>=100)&&1!==Ce[t]&&!Ge.getElementById("ns")&&function(e){if(v){var t=Ge.createElement("div"),n=Ge.createElement("div"),i=Ge.createElement("a"),a=Ge.createElement("a");n.style.textAlign="center",i.href=nt,i.classList.add("btn"),i.target="_blank",i.innerHTML=chrome.i18n.getMessage("generalCtaSubscribe"),a.id="ns",a.style.display="block",a.style.textDecoration="underline",a.textContent=chrome.i18n.getMessage("generalCont"),a.onclick=function(){t.remove(),Ft(),e.i=e.k=0,$t({o:e})},n.append(i,a),t.style.background="#a8201a",t.style.color="#fff",t.style.fontFamily="Calibri,sans-serif",t.style.fontSize="18px",t.style.padding="1.5em 2em",t.innerHTML=st[Dt(0,st.length-1)]+chrome.i18n.getMessage("generalDev")+"<br>",t.appendChild(n),v.parentNode.insertBefore(t,v),Ft()}}(Ce),J===e.catnow&&F.length===e.cats.length&&JSON.stringify(F)===JSON.stringify(e.cats)&&JSON.stringify(d)===e.rules||(Ot("fields"),Ot("cats"),Yt()))})),St()})),window.addEventListener("hashchange",(function(){var e=location.hash.slice(1)||"fields";e!==Ge.body.id&&Mt(e)})),window.addEventListener("load",(function(){if(Ge.querySelectorAll("[data-i18n]").forEach((function(e){var t=e.getAttribute("data-i18n"),n=chrome.i18n.getMessage(t),i=chrome.i18n.getMessage(t+"TT");n&&("search"===e.type?e.placeholder=n:e.innerHTML?e.innerHTML+=" "+n:e.innerHTML=n),i&&(e.title=i)})),Ge.querySelectorAll(".social-link").forEach((function(e){switch(e.id){case"facebook":e.href="https://www.facebook.com/sharer.php?u="+encodeURIComponent("https://chrome.google.com/webstore/detail/autofill/nlmmgnhgdeffjkdckmikfpnddkbbfkkk");break;case"twitter":e.href="https://twitter.com/intent/tweet?text="+encodeURIComponent(chrome.i18n.getMessage("socialMessage"+Dt(1,8))+" https://chrome.google.com/webstore/detail/autofill/nlmmgnhgdeffjkdckmikfpnddkbbfkkk")}})),Ge.querySelectorAll(".tt-anchor").forEach((function(e){e.addEventListener("mousemove",(function(e){Ye&&"block"===Ye.style.display&&l.pos(e)}))})),pt){var e=Ge.createElement("button"),t=Ge.getElementById("content-search");e.type="reset",e.title=chrome.i18n.getMessage("buttonsClearTT"),e.innerHTML="&times;",t&&(t.appendChild(e),t.addEventListener("reset",Pt))}Ot(),St()}));export{Ge as D,o as W,Lt as disableButtons,P as elT,j as elTB,Ye as elTT,xt as err,Se as oO};
